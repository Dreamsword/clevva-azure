{
    "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
    "handler": "Microsoft.Azure.CreateUIDef",
    "version": "0.1.2-preview",
    "parameters": {
        "resourceTypes": [
            "microsoft.resources/resourcegroups"
        ],
		"config": {
			"isWizard": true
		},
        "basics": [],
        "steps": [
			{
                "name": "Location",
                "type": "Microsoft.Common.DropDown",
                "label": "Location",
                "defaultValue": "[[resourceGroup().location]",
                "toolTip": "Location for all resources.",
                "constraints": {
                    "required": false,
                    "allowedValues": [
                        {
                            "label": "eastasia",
                            "value": "eastasia"
                        },
                        {
                            "label": "southeastasia",
                            "value": "southeastasia"
                        },
                        {
                            "label": "australiaeast",
                            "value": "australiaeast"
                        },
                        {
                            "label": "brazilsouth",
                            "value": "brazilsouth"
                        },
                        {
                            "label": "canadacentral",
                            "value": "canadacentral"
                        },
                        {
                            "label": "eastus2",
                            "value": "eastus2"
                        },
                        {
                            "label": "eastus",
                            "value": "eastus"
                        },
                        {
                            "label": "centralus",
                            "value": "centralus"
                        },
                        {
                            "label": "northcentralus",
                            "value": "northcentralus"
                        },
                        {
                            "label": "francecentral",
                            "value": "francecentral"
                        },
                        {
                            "label": "uksouth",
                            "value": "uksouth"
                        },
                        {
                            "label": "centralindia",
                            "value": "centralindia"
                        },
                        {
                            "label": "southindia",
                            "value": "southindia"
                        },
                        {
                            "label": "japaneast",
                            "value": "japaneast"
                        },
                        {
                            "label": "koreacentral",
                            "value": "koreacentral"
                        },
                        {
                            "label": "northeurope",
                            "value": "northeurope"
                        },
                        {
                            "label": "westcentralus",
                            "value": "westcentralus"
                        },
                        {
                            "label": "westeurope",
                            "value": "westeurope"
                        },
                        {
                            "label": "westus2",
                            "value": "westus2"
                        },
                        {
                            "label": "westus",
                            "value": "westus"
                        },
                        {
                            "label": "southcentralus",
                            "value": "southcentralus"
                        },
                        {
                            "label": "[concat('', '[resourceGroup().location]')]",
                            "value": "[concat('', '[resourceGroup().location]')]"
                        }
                    ]
                },
                "visible": true
            },
			{
				"name": "webAppConfig",
                "label": "WebApp Settings",
                "subLabel": {
                    "preValidation": "Configure the WebApp's resources and settings",
                    "postValidation": "Done"
                },
                "bladeTitle": "WebApp Settings",
                "elements": [
					{
            		    "name": "webAppName",
            		    "type": "Microsoft.Common.TextBox",
            		    "label": "Web App Name",
            		    "defaultValue": "Clevva-Web-App",
            		    "toolTip": "Base name of the resource such as Clevva-Web-App.",
            		    "constraints": {
            		        "required": false,
                            "regex": "^[a-z0-9A-Z-]{3,79}$",
                            "validationMessage": "The name must be between 3 and 79 characters long and contain letters, numbers and hyphens only."
            		    },
            		    "visible": true
            		},
					{
                		"name": "manualUpdate",
                		"type": "Microsoft.Common.DropDown",
                		"label": "Manual Update",
                		"defaultValue": "true",
                		"toolTip": "Set to false if you would like the Clevva software to update automatically",
                		"constraints": {
                		    "required": false,
                		    "allowedValues": [
                		        {
                		            "label": "true",
                		            "value": true
                		        },
                		        {
                		            "label": "false",
                		            "value": false
                		        }
                		    ]
                		},
                		"visible": true
            		}
				]
			},
			{
				"name": "dbConfig",
                "label": "Database Settings",
                "subLabel": {
                    "preValidation": "Configure the Database's resources and settings",
                    "postValidation": "Done"
                },
                "bladeTitle": "Database Settings",
                "elements": [
            		{
            		    "name": "databaseUser",
            		    "type": "Microsoft.Common.TextBox",
            		    "label": "Database User",
            		    "defaultValue": "clevvapro",
            		    "toolTip": "Name of the database user.",
            		    "constraints": {
            		        "required": false,
                            "regex": "^[a-z0-9A-Z]{4,30}$",
                            "validationMessage": "Only alphanumeric characters are allowed, and the value must be 4-30 characters long."
            		    },
            		    "visible": true
            		},
            		{
            		    "name": "databasePassword",
            		    "type": "Microsoft.Common.PasswordBox",
            		    "label": {
            		        "password": "Database Password",
            		        "confirmPassword": "Confirm password"
            		    },
            		    "toolTip": "Password of the database user.",
            		    "constraints": {
            		        "required": true,
                            "regex": "^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z])[\\w~@#$%^&*+=|{}:;!.?\\()\\[\\]-]{12,}$",
                            "validationMessage": "The password must contain at least 12 characters, with at least 1 uppercase, 1 lowercase and 1 number."
            		    },
            		    "options": {
            		        "hideConfirmation": false
            		    },
            		    "visible": true
            		},
            		{
            		    "name": "databaseResources",
            		    "type": "Microsoft.Common.DropDown",
            		    "label": "Database Resources",
            		    "toolTip": "Entry Level: 4vCPU; Mid Level: 16vCPU; Enterprise: 64vCPU",
            		    "constraints": {
            		        "required": true,
            		        "allowedValues": [
            		            {
            		                "label": "Entry Level Speed",
            		                "value": "GP_Gen5_4"
            		            },
            		            {
            		                "label": "Mid Level Speed",
            		                "value": "GP_Gen5_16"
            		            },
            		            {
            		                "label": "Enterprise Level Speed",
            		                "value": "GP_Gen5_64"
            		            }
            		        ]
            		    },
            		    "visible": true
            		}
				]
			}
		],
        "outputs": {
			"webAppName": "[steps('webAppConfig').webAppName.name]",
            "ManualUpdate": "[steps('webAppConfig').manualUpdate]",
            "DatabaseUser": "[steps('dbConfig').databaseUser]",
			"DatabasePassword": "[steps('dbConfig').databasePassword]",
			"DatabaseResources": "[steps('dbConfig').databaseResources]",
            "Location": "[steps('location')]"
        }
    }
}